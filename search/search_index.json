{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"BroomSvc","text":""},{"location":"#tech-stack","title":"Tech stack","text":"<ul> <li>IdP: Google (OAuth2)</li> <li>DB: PostgreSQL</li> <li>Backend: ASP.NET Core (C#)</li> <li>Frontend: Kombinovan\u00fd s BE - Blazor</li> </ul>"},{"location":"admin/","title":"Admin panel","text":""},{"location":"admin/#sprava-uzivatelu","title":"Spr\u00e1va u\u017eivatel\u016f","text":""},{"location":"admin/#stavy-uzivatelskeho-uctu","title":"Stavy u\u017eivatelsk\u00e9ho \u00fa\u010dtu","text":"<pre><code>stateDiagram-v2\n     [*] --&gt; Nov\u00fd\n    Nov\u00fd --&gt; Registrovan\u00fd\n\n    state hasRole &lt;&lt;choice&gt;&gt;\n    note left of hasRole\n          M\u00e1 roli?\n     end note\n    Registrovan\u00fd --&gt; hasRole\n    hasRole --&gt; Registrovan\u00fd: [ Ne ]\n    hasRole --&gt; Aktivn\u00ed: [ Ano ]\n\n    state stillHasRole &lt;&lt;choice&gt;&gt;\n    note right of stillHasRole\n          St\u00e1le m\u00e1 roli?\n     end note\n    Aktivn\u00ed --&gt; stillHasRole\n    stillHasRole --&gt; Aktivn\u00ed: [ Ano ]\n    stillHasRole --&gt; Neaktivn\u00ed: [ Ne ]\n    Neaktivn\u00ed --&gt; hasRole</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"admin/#seznam-uzivatelu","title":"Seznam u\u017eivatel\u016f","text":"<p>Zobrazen\u00e9 polo\u017eky:</p> <ul> <li>Email</li> <li>Jm\u00e9no</li> <li>P\u0159\u00edjmen\u00ed</li> <li>P\u0159id\u011blen\u00e9 role</li> <li>Registrov\u00e1n</li> </ul> <p>Dostupn\u00e9 akce:</p> <ul> <li>P\u0159idat/pozvat u\u017eivatele</li> <li>Upravit u\u017eivatele</li> <li>Odebrat u\u017eivatele</li> </ul>"},{"location":"admin/#pridani-uzivatele","title":"P\u0159id\u00e1n\u00ed u\u017eivatele","text":"<ul> <li>Unik\u00e1tnost u\u017eivatel\u016f na z\u00e1klad\u011b emailu (@gmail?)</li> <li>Vstup:<ul> <li>Email</li> <li>Jm\u00e9no</li> <li>P\u0159\u00edjmen\u00ed</li> </ul> </li> <li>Kontroly:<ul> <li>Email: je validn\u00ed email</li> <li>Jm\u00e9no: nen\u00ed pr\u00e1zdn\u00e9</li> <li>P\u0159\u00edjmen\u00ed: nen\u00ed pr\u00e1zdn\u00e9</li> </ul> </li> <li>Zpracov\u00e1n\u00ed:<ul> <li>Vyhodnotit kontroly</li> <li>Zkontrolovat, \u017ee je\u0161t\u011b neexistuje u\u017eivatel s dan\u00fdm emailem<ul> <li>Pokud existuje, zastavit zpracov\u00e1n\u00ed a zobrazit chybu</li> </ul> </li> <li>Do tabulky <code>Users</code> vlo\u017eit nov\u00fd z\u00e1znam se stavem <code>New</code></li> <li>Transak\u010dn\u011b ulo\u017eit zm\u011bny do DB</li> <li>P\u0159esm\u011brovat p\u0159ihl\u00e1\u0161en\u00e9ho u\u017eivatele na detail p\u0159idan\u00e9ho u\u017eivatele</li> </ul> </li> </ul>"},{"location":"admin/#uprava-uzivatele","title":"\u00daprava u\u017eivatele","text":"<ul> <li>Ze seznamu u\u017eivatel\u016f p\u0159ej\u00edt na str\u00e1nku detailu konkr\u00e9tn\u00edho u\u017eivatele (bude to implementa\u010dn\u011b snaz\u0161\u00ed, ne\u017e to d\u011blat v mod\u00e1ln\u00edm dialogu)</li> <li>Needitovateln\u00e9 polo\u017eky:<ul> <li>Id</li> <li>Email</li> </ul> </li> <li>Editovateln\u00e9 polo\u017eky:<ul> <li>Jm\u00e9no</li> <li>P\u0159\u00edjmen\u00ed</li> <li>Role</li> </ul> </li> <li>P\u0159i\u0159adit p\u016fjdou pouze takov\u00e9 role, kter\u00e9 je\u0161t\u011b u\u017eivatel nem\u00e1 p\u0159i\u0159azeny</li> <li>Odebrat p\u016fjdou pouze aktu\u00e1ln\u011b p\u0159i\u0159azen\u00e9 role</li> <li>Kontroly: viz P\u0159id\u00e1n\u00ed u\u017eivatele</li> <li>Zpracov\u00e1n\u00ed:<ul> <li>Vyhodnotit kontroly</li> <li>Pro v\u0161echny zm\u011bn\u011bn\u00e9 hodnoty (Jm\u00e9no, p\u0159\u00edjmen\u00ed, role)<ul> <li>Vytvo\u0159it nov\u00fd z\u00e1znam v <code>UsersAudit</code></li> <li>Zm\u011bnit hodnotu            </li> </ul> </li> <li>Vyhodnotit nov\u00fd stav \u00fa\u010dtu:<ul> <li>Pokud je st\u00e1vaj\u00edc\u00ed stav <code>Registered</code> nebo <code>Inactive</code> a \u00fa\u010det m\u00e1 alespo\u0148 jednu roli:<ul> <li>Vytvo\u0159it nov\u00fd z\u00e1znam v <code>UsersAudit</code></li> <li>Nastavit stav na <code>Active</code></li> </ul> </li> <li>Pokud je st\u00e1vaj\u00edc\u00ed stav <code>Active</code> a \u00fa\u010det nem\u00e1 \u017e\u00e1dnou roli:<ul> <li>Vytvo\u0159it nov\u00fd z\u00e1znam v <code>UsersAudit</code></li> <li>Nastavit stav na <code>Inactive</code></li> </ul> </li> </ul> </li> <li>Transak\u010dn\u011b ulo\u017eit zm\u011bny do DB</li> <li>P\u0159esm\u011brovat p\u0159ihl\u00e1\u0161en\u00e9ho u\u017eivatele na seznam u\u017eivatel\u016f</li> </ul> </li> </ul>"},{"location":"admin/#registrace-uzivatele","title":"Registrace u\u017eivatele","text":"<p>Registrace == odsouhlasen\u00ed \u00fadaj\u016f (jm\u00e9no, p\u0159\u00edjmen\u00ed).</p> <ul> <li>Email u\u017eivatel, kter\u00fd se pokou\u0161\u00ed p\u0159ihl\u00e1sit, mus\u00ed b\u00fdt p\u0159i\u0159azen\u00fd k n\u011bjak\u00e9mu z\u00e1znamu v datab\u00e1zi - <code>Admin</code> u\u017eivatel u\u017eivatele vytvo\u0159il<ul> <li>Pokud email v DB nebude, tak nelze registraci prov\u00e9st</li> </ul> </li> <li>Kontroly:<ul> <li>U\u017eivatel s dan\u00fdm emailem je zalo\u017een</li> <li>\u00da\u010det u\u017eivatele je ve stavu <code>New</code></li> </ul> </li> <li>Zpracov\u00e1n\u00ed:<ul> <li>Z\u00edskat email aktu\u00e1ln\u011b p\u0159ihl\u00e1\u0161en\u00e9ho u\u017eivatele (Principal)</li> <li>Vyhodnotit kontroly</li> <li>Na\u010d\u00edst z datab\u00e1ze objekt u\u017eivatele</li> <li>Zobrazit u\u017eivateli hodnoty z datab\u00e1ze, jm\u00e9no a p\u0159\u00edjmen\u00ed m\u016f\u017ee upravit</li> <li>Aktualizovat \u00fadaje u\u017eivatele v datab\u00e1zi a nastavit nov\u00fd stav \u00fa\u010dtu:<ul> <li>Pokud m\u00e1 p\u0159i\u0159azeny role, nastavit stav na <code>Active</code></li> <li>Pokud \u017e\u00e1dn\u00e9 role nem\u00e1, nastavit stav na <code>Registered</code></li> </ul> </li> <li>Pokud je nov\u00fd stav \u00fa\u010dtu <code>Registered</code>, zobrazit u\u017eivateli informaci, \u017ee byl \u00fasp\u011b\u0161n\u011b zaregistrov\u00e1n, ale mus\u00ed vy\u010dkat na p\u0159i\u0159azen\u00ed role</li> </ul> </li> </ul>"},{"location":"roles/","title":"Seznam rol\u00ed v aplikaci","text":"Role Popis Cleaner Role ukl\u00edze\u010de apartm\u00e1n\u016f Admin Role administr\u00e1tora aplikace"},{"location":"cleanings/","title":"\u00daklidy","text":"<p>U\u017eivatel mus\u00ed m\u00edt roli <code>Cleaner</code> nebo <code>Admin</code>.</p> <p>Aplikace 1x za 30 minut st\u00e1hne kalend\u00e1\u0159e rezervac\u00ed a zkontroluje rezervace proti datab\u00e1zi, pokud n\u011bjak\u00e1 rezervace byla z kalend\u00e1\u0159\u016f odebr\u00e1na, tak ji odebere tak\u00e9 z datab\u00e1ze, stejn\u011b tak v p\u0159\u00edpad\u011b p\u0159idan\u00fdch rezervac\u00ed v kalend\u00e1\u0159i.</p> <p>\u00daklid je vy\u017eadov\u00e1n nejd\u0159\u00edve po 10. hodin\u011b v den ukon\u010den\u00ed rezervace (checkout), nejpozd\u011bji v\u0161ak n\u00e1sleduj\u00edc\u00ed den po ukon\u010den\u00ed pobytu. (?)</p> <p>Aplikace bude dr\u017eet informace o tom, jestli \u00faklid prob\u011bhl a kdo jej provedl/m\u011bl prov\u00e9st, u\u017eivatel v\u017edy bude muset potvrdit, \u017ee \u00faklid opravdu provedl.</p>"},{"location":"cleanings/#predstava","title":"P\u0159edstava","text":"<p>Aplikace bude u\u017eivateli zobrazovat rezervace, ve kter\u00fdch je mo\u017en\u00e9 prov\u00e9st \u00faklid, rezervace z minulosti bude zobrazovat v samostatn\u00e9 z\u00e1lo\u017ece. Zobrazovan\u00e9 polo\u017eky: <code>Datum skon\u010den\u00ed rezervace</code>, <code>N\u00e1zev apartm\u00e1nu</code>, <code>Kdo ukl\u00edz\u00ed</code>.</p> <p>U\u017eivatel bude m\u00edt u ka\u017ed\u00e9 rezervace tla\u010d\u00edtko, kter\u00fdm si zvol\u00ed, \u017ee danou rezervaci uklid\u00ed pr\u00e1v\u011b on. Pokud m\u00e1 zvolenou rezervaci ukl\u00edzet jin\u00fd u\u017eivatel, bude o tom u\u017eivatel (kter\u00fd si chce \u00faklid vz\u00edt) informov\u00e1n mod\u00e1ln\u00edm dialogem s mo\u017enost\u00ed si \u00faklid p\u0159evz\u00edt. U\u017eivatel bude m\u00edt mo\u017enost se odebrat ze \"sv\u00fdch\" \u00faklid\u016f, \u010d\u00edm\u017e je uvoln\u00ed pro ostatn\u00ed u\u017eivatele.</p> <p>Po uplynut\u00ed doby rezervace bude u\u017eivateli zp\u0159\u00edstupn\u011bna mo\u017enost ozna\u010dit \u00faklid za dokon\u010den\u00fd. Tyto \u00faklidy budou zobrazeny nad seznamem dostupn\u00fdch \u00faklid\u016f/rezervac\u00ed v r\u00e1mci \"prob\u00edhaj\u00edc\u00edch \u00faklid\u016f\", zde se budou zobrazovat pouze \u00faklidy, kter\u00e9 m\u00e1 dan\u00fd u\u017eivatel p\u0159i\u0159azen\u00e9.</p> <p><code>Admin</code> u\u017eivatel bude moci ke ka\u017ed\u00e9 rezervaci p\u0159i\u0159adit (i zm\u011bnit na) jin\u00e9ho <code>Cleaner</code> u\u017eivatele, tak\u00e9 bude moci ozna\u010dit dokon\u010den\u00e9 \u00faklidy.</p>"},{"location":"cleanings/#uzivatelske-rozhrani","title":"U\u017eivatelsk\u00e9 rozhran\u00ed","text":"<p>Polo\u017eky rezervac\u00ed/\u00faklid\u016f budou zobrazeny jednodu\u0161e v seznamu, zat\u00edm asi nem\u00e1 smysl vytv\u00e1\u0159et slo\u017eit\u00fd kalend\u00e1\u0159, ve kter\u00e9m by byly rezervace zobrazeny a bylo mo\u017eno si v r\u00e1mci kalend\u00e1\u0159e nastavovat \u00faklidy.</p> <p>Stav jednotliv\u00fdch rezervac\u00ed bude barevn\u011b rozli\u0161en, nap\u0159\u00edklad:</p> <p>Pro lep\u0161\u00ed p\u0159ehlednost se pou\u017e\u00edvaj\u00ed 4 barvy + ikony:</p> <ul> <li> <p>\ud83d\udfe6 Modr\u00e1 (Voln\u00fd \u00faklid) </p> <ul> <li>Stav: rezervace je voln\u00e1, nikdo ji nem\u00e1.  </li> <li>Akce: tla\u010d\u00edtko \u201eVezmu si \u00faklid\u201c.  </li> <li>Ikona: \u2795 (plus) nebo \ud83d\udd90\ufe0f.  </li> </ul> </li> <li> <p>\ud83d\udfe7 Oran\u017eov\u00e1 (\u010cek\u00e1 na m\u011b) </p> <ul> <li>Stav: \u00faklid m\u00e1m p\u0159i\u0159azen\u00fd j\u00e1, ale je\u0161t\u011b nen\u00ed hotovo.  </li> <li>Akce: tla\u010d\u00edtko \u201ePotvrdit \u00faklid\u201c.  </li> <li>Ikona: \u23f3 (p\u0159es\u00fdpac\u00ed hodiny).  </li> </ul> </li> <li> <p>\ud83d\udfe9 Zelen\u00e1 (Hotovo) </p> <ul> <li>Stav: \u00faklid byl potvrzen.  </li> <li>Akce: \u017e\u00e1dn\u00e1 (jen zobrazen\u00ed).  </li> <li>Ikona: \u2705 (fajfka).  </li> </ul> </li> <li> <p>\ud83d\udfe5 \u010cerven\u00e1 (Probl\u00e9m / Pro\u0161l\u00e9) </p> <ul> <li>Stav: \u00faklid m\u011bl b\u00fdt proveden, ale nen\u00ed.  </li> <li>Akce: admin m\u016f\u017ee p\u0159i\u0159adit jin\u00e9mu ukl\u00edze\u010di nebo ozna\u010dit ru\u010dn\u011b.  </li> <li>Ikona: \u274c (k\u0159\u00ed\u017eek).  </li> </ul> </li> </ul>"},{"location":"cleanings/#historie-uklidu","title":"Historie \u00faklid\u016f","text":"<p>U\u017eivatel bude m\u00edt mo\u017enost si zobrazit historii \u00faklid\u016f, kter\u00e9 provedl (nebo neprovedl?). Historie bude pouze pro \u010dten\u00ed a u\u017eivatel uvid\u00ed stejn\u00e9 polo\u017eky, jako v prob\u00edhaj\u00edc\u00edch rezervac\u00edch/\u00faklidech.</p> <p><code>Admin</code> u\u017eivatel si bude moci zobrazit historii pro v\u0161echny u\u017eivatele najednou (kompletn\u00ed historie), ale tak\u00e9 pouze pro konkr\u00e9tn\u00edho u\u017eivatele.</p>"},{"location":"db/","title":"Datab\u00e1ze","text":"<p>Pro spr\u00e1vu DB je pou\u017eit EF Core.</p> <p>DB provider je PostgreSQL.</p>"},{"location":"db/#db-schema","title":"DB Sch\u00e9ma","text":"<p>(sch\u00e9ma entit, EF Core m\u00e1 ve spr\u00e1v\u011b celou DB)</p> <pre><code>erDiagram\n\nUsers {\n    int Id PK\n    string Email UK \"NN\"\n    string FirstName \"NN\"\n    string LastName \"NN\"\n    UserAccountState State \"NN &lt;br/&gt; ENUM(New, Registered, Active, Inactive)\"\n}\n\nUserRoles {\n    int Id PK\n    int UserId FK \"NN\"\n    string Role \"NN\"\n    constraint _ \"UK(UserId, Role)\"\n}\n\nUsers ||--o{ UserRoles : \"\"\n\nUsersAudit {\n    int Id PK\n    int UserId \"NN\"\n    int ChangedBy \"NN\"\n    string Action \"NN\"\n    DateTime ChangeDate \"NN\"\n}\n\nUsers ||--o{ UsersAudit : \"\"\n\nApartments {\n    int Id PK\n    string Name \"NN\"\n}\n\nApartmentReservationLinks {\n    int Id PK\n    int ApartmentId FK \"NN\"\n    string ReservationsICalUri \"NN\"\n}\n\nReservations {\n    int Id PK\n    int ApartmentId FK \"NN\"\n    DateOnly StartDate \"NN\"\n    DateOnly EndDate \"NN\"\n    string ICalEventId \"NN\"\n}\n\nCleanings {\n    int Id PK\n    int ReservationId FK \"NN\"\n    int AppartmentId FK \"NN\"\n    int UserId FK \"NN\"\n    DateTimeOffset ConfirmedAt\n}\n\nApartmentsAudits {\n    int Id PK\n    int ApartmentId \"NN\"\n    int ChangedBy \"NN\"\n    string Action \"NN\"\n    DateTime ChangeDate \"NN\"\n}\n\nApartments ||--o{ Reservations : \"\"\nApartments ||--o{ ApartmentsAudits : \"\"\nApartments ||--o{ ApartmentReservationLinks: \"\"\nReservations ||--|| Cleanings : \"\"\nCleanings ||--|| Users : \"\"</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"}]}